{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Invoice â€“ {{ invoice.invoice_no }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        @page { 
            size: A4; 
            margin: 20mm;
        }
        body { 
            font-size: 13px; 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 15px; 
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        table th, table td {
            padding: 4px 6px !important;
            border: 1px solid #000 !important;
            vertical-align: top;
        }

        /* Dotted lines for items */
        .items-table tbody tr td {
            border-bottom: 1px dotted #000 !important;
        }

        .table-header {
            background: #efefef;
            font-weight: bold;
        }

        .signature {
            width: 100%;
            margin-top: 40px;
        }

        .signature td {
            border: none !important;
            padding: 0 !important;
            vertical-align: bottom;
        }

        .text-end { text-align: right; }

        .rounded-box {
            border: 1px solid #000;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
        }

        hr.custom-hr {
            border-top: 1px solid #000;
            margin: 4px 0;
        }

        .company-logo {
            max-height: 60px;
            margin-bottom: 5px;
        }

        .header-spacing {
            margin-bottom: 20px;
        }

        .buyer-consignee-spacing {
            margin-bottom: 20px;
        }
		
.no-border-row td {
    border: none !important;      /* remove borders for these cells */
    background-color: transparent !important;
}

/* Remove horizontal borders */
.items-table td {
    border-top: none !important;
    border-bottom: none !important;
}

/* Keep vertical borders */
.items-table td + td {
    border-left: 1px solid #000 !important;
}

.company-logo {
    height: 100px;   /* Adjust height */
    width: auto;     /* Preserve aspect ratio */
}

</style>


    </style>
</head>

<body>

<!-- ===== HEADER ===== -->
<div class="text-center header-spacing">
    <h4><b>TAX INVOICE</b></h4>
</div>

<!-- ===== COMPANY INFO + INVOICE/BANK BOX ===== -->
<table class="table table-bordered mb-3">
    <tr>
        <!-- Left: Company Info + Logo -->
        <td width="55%" style="vertical-align: top;">
			<table style="width: 100%; border-collapse: collapse; border: none;">
    <tr>
        <!-- Company Info -->
        <td style="border: none; width: 70%; vertical-align: top;">
            <b>{{ company.name }}</b><br>
            {{ company.address }}<br>
            GSTIN/UIN: <b>{{ company.gstin }}</b><br>
            State: {{ company.state_name }} (Code: {{ company.state_code }})<br>
            Contact: <b>{{ company.contact }}</b>
        </td>
		<td width="30%">
			<div style="display: flex; justify-content: center; align-items: center; height: 100%;">
				<img src="{{ company.logo_url }}" alt="Company Logo" class="company-logo" style="height: auto; width: auto;">
			</div>
	    </td>
    </tr>
</table>


        </td>

        <!-- Right: Invoice + Bank Details Box merged vertically -->
        <td width="45%" rowspan="2" style="vertical-align: top;">
            <div class="rounded-box">
                <b>Invoice No:</b> {{ invoice.invoice_no }}<br>
                <b>Date:</b> {{ invoice.date }}<br>
                <b>Vehicle No:</b> {{ invoice.vehicle_no }}<br>
                <b>Dispatched through:</b> {{ invoice.dispatched_through }}<br>
				<b>Delivery Terms:</b> {{ invoice.delivery_terms }}<br>
            </div>
			<br><br><br>
            <div class="rounded-box">
                <b>Company Bank Details</b><br>
                <b>Account Name:</b> {{ company.bank_account_name }}<br>
                <b>Bank:</b> {{ company.bank_name }}<br>
                <b>A/c Number:</b> {{ company.bank_account_no }}<br>
                <b>Branch:</b> {{ company.bank_branch }}<br>
                <b>IFSC:</b> {{ company.bank_ifsc }}
            </div>
        </td>
    </tr>

    <!-- Buyer + Consignee -->
    <tr>
        <td width="55%" class="buyer-consignee-spacing">
            <b><u>Buyer (Bill To)</u></b><br>
            <b>{{ consignee.name }}</b><br>
            {{ consignee.address|linebreaksbr }} <br>
            GSTIN: <b>{{ consignee.gstin }}</b><br>
			Contact:  <b>{{ consignee.contact }} </b><br>
            <!--State: {{ invoice.bill_to_state }} (Code: {{ invoice.bill_to_state_code }})<br> -->

            <hr class="custom-hr">

            <b><u>Consignee (Ship To)</u></b><br>
            <b>{{ buyer.name }}</b><br>
            {{ buyer.address|linebreaksbr }}<br>
            GSTIN:  <b>{{ buyer.gstin }} </b><br>
			Contact:  <b>{{ buyer.contact }} </b><br>
            <!--State: {{ invoice.ship_to_state }} (Code: {{ invoice.ship_to_state_code }}) -->
        </td>
    </tr>
</table>

<!-- ===== ITEMS TABLE WITH DOTTED LINES ===== -->
<table class="table table-bordered items-table">
    <thead class="table-header">
        <tr>
            <th width="5%">S.No</th>
            <th>Description</th>
            <th width="10%">HSN</th>
            <th width="20%" class="text-end">Qty</th>
            <th width="10%" class="text-end">Rate</th>
            <th width="15%" class="text-end">Amount</th>
        </tr>
    </thead>
	<tbody>
  {% for item in items %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ item.description }}</td>
            <td>{{ item.hsn }}</td>
            <td class="text-end">{{ item.quantity }}</td>
            <td class="text-end">{{ item.rate }}</td>
            <td class="text-end">{{ item.amount }}</td>
        </tr>
        {% endfor %}
	</tbody>
    <tr>
        <th colspan="3" class="text-end">SUB TOTAL</th>
        <th class="text-end"><b>{{ invoice.total_quantity }}</b></th>
        <th></th>
        <th class="text-end"><b>{{ invoice.subtotal }}</b></th>
    </tr>

    {% if igst_amount > 0 %}
    <tr>
        <td colspan="5" class="text-end"><b>IGST ({{ invoice.igst_rate }}%)</b></td>
        <td class="text-end">{{ invoice.igst_amount }}</td>
    </tr>
    {% else %}
    <tr>
        <td colspan="5" class="text-end"><b>CGST ({{ invoice.cgst_rate }}%)</b></td>
        <td class="text-end">{{ invoice.cgst_amount }}</td>
    </tr>
    <tr>
        <td colspan="5" class="text-end"><b>SGST ({{ invoice.sgst_rate }}%)</b></td>
        <td class="text-end">{{ invoice.sgst_amount }}</td>
    </tr>
    {% endif %}

    <tr>
        <td colspan="5" class="text-end"><b>ROUND OFF</b></td>
        <td class="text-end">{{ invoice.round_off }}</td>
    </tr>

    <tr>
        <th colspan="5" class="text-end"><b>GRAND TOTAL</b></th>
        <th class="text-end"><b>{{ invoice.total }}</b></th>
    </tr>
</table>

<!-- ===== AMOUNT IN WORDS ===== -->
<table class="table table-bordered">
    <tr>
        <td width="70%">
            <b>Amount in Words:</b><br>
            {{ invoice.amount_words }} 
        </td>
        <td width="30%" class="text-end">
            <b>E. & O.E</b>
        </td>
    </tr>
</table>

<!-- ===== DECLARATION + SIGNATURE ===== -->
<table class="table table-bordered">
    <tr>
        <td width="100%" style="position: relative;">
            <div style="float: left; width: 60%;">
                <b>Declaration</b><br>
                We declare that this invoice shows the actual price of the<br>
                goods described and that all particulars are true and correct.
            </div>
            <div style="float: right; width: 40%; text-align: center;">
                <b>for {{ company.name }}</b><br><br><br>
                Authorised Signatory
            </div>
        </td>
    </tr>
</table>

<p style="text-align: center; margin: 0;"><i>This is a computer-generated invoice.</i></p>

</body>
</html>
